<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StatusSync Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1>ğŸ“Š StatusSync Dashboard</h1>
            <div class="guild-selector" id="guild-selector" style="display: none;">
                <label for="guild-select">Server:</label>
                <select id="guild-select" onchange="selectGuild()">
                    <option value="">Select a server...</option>
                </select>
                <button onclick="loadDashboard()" class="btn-primary">Load</button>
                <button onclick="logout()" class="btn-secondary" style="margin-left: 10px;">Logout</button>
            </div>
            <div id="login-container">
                <button onclick="login()" class="btn-primary">Login with Discord</button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <button onclick="showTab('overview')" class="nav-btn active" data-tab="overview">Overview</button>
            <button onclick="showTab('moderation')" class="nav-btn" data-tab="moderation">Moderation</button>
            <button onclick="showTab('leaderboards')" class="nav-btn" data-tab="leaderboards">Leaderboards</button>
            <button onclick="showTab('settings')" class="nav-btn" data-tab="settings">Settings</button>
            <button onclick="showTab('logs')" class="nav-btn" data-tab="logs">Logs</button>
            <button onclick="showTab('premium')" class="nav-btn" data-tab="premium">ğŸ’ Premium</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Loading dashboard...</p>
        </div>

        <!-- Error State -->
        <div id="error" class="error" style="display: none;">
            <h2>âš ï¸ Error</h2>
            <p id="error-message"></p>
        </div>

        <!-- Overview Tab -->
        <div id="tab-overview" class="tab-content active">
            <h2>Server Overview</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ‘¥</div>
                    <div class="stat-info">
                        <h3 id="stat-users">0</h3>
                        <p>Total Users</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">âš–ï¸</div>
                    <div class="stat-info">
                        <h3 id="stat-cases">0</h3>
                        <p>Mod Cases</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’¬</div>
                    <div class="stat-info">
                        <h3 id="stat-commands">0</h3>
                        <p>Custom Commands</p>
                    </div>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <h3>ğŸ“ˆ Top Users by Reputation</h3>
                    <div id="top-rep" class="list"></div>
                </div>
                <div class="card">
                    <h3>ğŸ¯ Top Users by XP</h3>
                    <div id="top-xp" class="list"></div>
                </div>
            </div>

            <div class="card">
                <h3>ğŸ“Š Moderation Activity (by Type)</h3>
                <div id="cases-chart"></div>
            </div>
        </div>

        <!-- Moderation Tab -->
        <div id="tab-moderation" class="tab-content">
            <h2>Moderation Panel</h2>
            
            <div class="card">
                <h3>ğŸ” Search User History</h3>
                <div class="search-bar">
                    <input type="text" id="user-id-input" placeholder="Enter Discord User ID">
                    <button onclick="fetchUserHistory()" class="btn-primary">Search</button>
                </div>
                <div id="userhistory-list" class="list"></div>
            </div>

            <div class="card">
                <h3>ğŸ“‹ Recent Mod Cases</h3>
                <div class="table-responsive">
                    <table id="cases-table">
                        <thead>
                            <tr>
                                <th>Case #</th>
                                <th>User ID</th>
                                <th>Action</th>
                                <th>Reason</th>
                                <th>Moderator</th>
                                <th>Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="cases-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Leaderboards Tab -->
        <div id="tab-leaderboards" class="tab-content">
            <h2>Leaderboards</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>ğŸ† Reputation Leaders</h3>
                    <div id="rep-leaderboard" class="leaderboard"></div>
                </div>
                <div class="card">
                    <h3>âš¡ XP Leaders (All Time)</h3>
                    <div id="xp-leaderboard" class="leaderboard"></div>
                </div>
                <div class="card">
                    <h3>ğŸ“… Weekly XP Leaders</h3>
                    <div id="weekly-leaderboard" class="leaderboard"></div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="tab-settings" class="tab-content">
            <h2>Server Configuration</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>ğŸ‘‹ Welcome Channel</h3>
                    <p id="setting-welcome" class="setting-value">Not configured</p>
                </div>
                <div class="card">
                    <h3>âš–ï¸ Mod Log Channel</h3>
                    <p id="setting-modlog" class="setting-value">Not configured</p>
                </div>
                <div class="card">
                    <h3>ğŸ“ Logging Channel</h3>
                    <p id="setting-logging" class="setting-value">Not configured</p>
                </div>
                <div class="card">
                    <h3>â­ Starboard Settings</h3>
                    <div id="setting-starboard" class="setting-value">Not configured</div>
                </div>
            </div>

            <div class="card">
                <h3>ğŸ”§ Custom Commands</h3>
                <div id="commands-list" class="list"></div>
            </div>
        </div>

        <!-- Logs Tab -->
        <div id="tab-logs" class="tab-content">
            <h2>Moderation Logs</h2>
            
            <div class="card">
                <div class="table-responsive">
                    <table id="logs-table">
                        <thead>
                            <tr>
                                <th>Log ID</th>
                                <th>Case #</th>
                                <th>User ID</th>
                                <th>Moderator ID</th>
                                <th>Action</th>
                                <th>Reason</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="logs-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Premium Tab -->
        <div id="tab-premium" class="tab-content">
            <h2>ğŸ’ Premium Features</h2>
            
            <!-- Current Status -->
            <div class="card" id="premium-status">
                <h3>Current Subscription</h3>
                <p id="premium-tier">Loading...</p>
            </div>

            <!-- Premium Feature Controls (only shown if premium active) -->
            <div id="premium-controls" style="display: none; margin-top: 2rem;">
                <div class="card">
                    <h3>âš™ï¸ Premium Settings</h3>
                    
                    <div style="margin: 1rem 0;">
                        <label style="display: block; margin-bottom: 0.5rem;">
                            <strong>Custom Bot Status</strong>
                            <input type="text" id="custom-status" placeholder="Enter custom status..." 
                                   style="width: 100%; padding: 0.5rem; margin-top: 0.25rem; background: #2c2f33; border: 1px solid #40444b; color: white; border-radius: 4px;">
                        </label>
                    </div>
                    
                    <div style="margin: 1rem 0;">
                        <label style="display: block; margin-bottom: 0.5rem;">
                            <strong>XP Multiplier</strong>
                            <input type="number" id="xp-multiplier" min="1" max="5" step="0.1" value="1.0"
                                   style="width: 100%; padding: 0.5rem; margin-top: 0.25rem; background: #2c2f33; border: 1px solid #40444b; color: white; border-radius: 4px;">
                            <small style="color: #99aab5;">1.0 = normal, 2.0 = double XP, max 5.0</small>
                        </label>
                    </div>
                    
                    <div style="margin: 1rem 0;">
                        <label style="display: block; margin-bottom: 0.5rem;">
                            <strong>Custom Embed Color</strong>
                            <input type="color" id="embed-color" value="#5865F2"
                                   style="width: 100%; height: 40px; padding: 0.25rem; margin-top: 0.25rem; background: #2c2f33; border: 1px solid #40444b; cursor: pointer; border-radius: 4px;">
                        </label>
                    </div>
                    
                    <div style="margin: 1rem 0;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="auto-mod-enabled">
                            <strong>Enable Advanced Auto-Moderation</strong>
                        </label>
                        <small style="color: #99aab5; margin-left: 1.5rem;">Spam filter, bad words, link blocking, caps lock detection</small>
                    </div>
                    
                    <div style="margin: 1rem 0;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="custom-welcome-enabled">
                            <strong>Enable Custom Welcome Messages</strong>
                        </label>
                        <small style="color: #99aab5; margin-left: 1.5rem;">Rich embeds with member stats and images</small>
                    </div>
                    
                    <button onclick="savePremiumSettings()" class="btn" style="margin-top: 1rem; background: #667eea;">
                        ğŸ’¾ Save Settings
                    </button>
                </div>
                
                <!-- Backup & Restore -->
                <div class="card" style="margin-top: 1rem;">
                    <h3>ğŸ’¾ Backup & Restore</h3>
                    <p style="color: #99aab5; margin-bottom: 1rem;">Save and restore your server configuration</p>
                    
                    <button onclick="createBackup()" class="btn" style="background: #3ba55d;">
                        ğŸ“¦ Create Backup
                    </button>
                    
                    <div id="backup-list" style="margin-top: 1rem;">
                        <!-- Backups will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Premium Tiers (shown if no premium) -->
            <div id="premium-tiers" class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); margin-top: 2rem;">
                <!-- Tiers will be loaded here -->
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>StatusSync Dashboard Â© 2025 | Made with â¤ï¸ for Discord</p>
        </div>
    </footer>

    <script src="frontend.js"></script>
</body>
</html>
